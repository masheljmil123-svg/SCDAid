<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SCDAid</title>

  <!-- IMPORTANT: use relative paths for GitHub Pages -->
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <div class="page">
    <header class="header card">
      <div class="brand">
        <!-- Put logo.png in the same folder as index.html -->
        <img class="logo" src="./logo.png" alt="SCDAid Logo" onerror="this.style.display='none'">
        <div class="brand-text">
          <div class="title-row">
            <h1 id="titleText">SCDAid</h1>
            <span class="badge">Prototype</span>
          </div>
          <p id="subtitleText" class="subtitle">
            SCD VOC analgesia decision support — Severity + CPIC (CYP2D6) + Renal & Safety guardrails
          </p>
        </div>
      </div>

      <div class="header-actions">
        <button id="langToggle" class="btn btn-ghost" type="button">AR</button>
      </div>
    </header>

    <main class="grid">
      <!-- Left: Inputs -->
      <section class="card">
        <h2 id="patientInputsTitle" class="card-title">Patient Inputs</h2>

        <div class="form-grid">
          <div class="field">
            <label id="ageLabel" for="ageInput">Age (years) *</label>
            <input id="ageInput" type="number" min="0" step="1" placeholder="e.g., 22" />
          </div>

          <div class="field">
            <label id="weightLabel" for="weightInput">Weight *</label>
            <div class="inline">
              <input id="weightInput" type="number" min="0" step="0.1" placeholder="e.g., 60" />
              <select id="weightUnit" aria-label="Weight unit">
                <option value="kg" selected>kg</option>
                <option value="lb">lb</option>
              </select>
            </div>
            <div id="weightHint" class="hint">Used to calculate adult starting doses.</div>
          </div>

          <div class="field">
            <label id="egfrLabel" for="gfrInput">eGFR (mL/min/1.73m²) *</label>
            <input id="gfrInput" type="number" min="0" step="1" placeholder="e.g., 95" />
            <div id="egfrHint" class="hint">Enter eGFR (mL/min/1.73m²).</div>
          </div>

          <div class="field">
            <label id="doseUnitLabel" for="doseUnit">Output Dose Unit</label>
            <select id="doseUnit">
              <option value="mg" selected>mg</option>
              <option value="mcg">mcg</option>
              <option value="g">g</option>
            </select>
            <div id="doseUnitHint" class="hint">Controls the unit used when displaying calculated doses.</div>
          </div>

          <div class="field">
            <label id="crisesLabel" for="crisesInput">Pain crises/year (optional)</label>
            <input id="crisesInput" type="number" min="0" step="1" placeholder="e.g., 4" />
          </div>

          <div class="field">
            <label id="severityLabel" for="severityInput">Pain severity *</label>
            <select id="severityInput">
              <option value="mild">Mild</option>
              <option value="moderate" selected>Moderate</option>
              <option value="severe">Severe</option>
            </select>
          </div>

          <div class="field">
            <label id="genoAvailLabel" for="genoAvail">CYP2D6 genotype availability</label>
            <select id="genoAvail">
              <option value="known" selected>Known</option>
              <option value="unknown">Unknown</option>
            </select>
            <div id="genoAvailHint" class="hint">If unknown, tool avoids CYP2D6-dependent opioids.</div>
          </div>

          <div class="field">
            <label id="cypLabel" for="cyp2d6Input">CYP2D6 phenotype</label>
            <select id="cyp2d6Input">
              <option value="PM">Poor (PM)</option>
              <option value="IM">Intermediate (IM)</option>
              <option value="EM" selected>Normal (EM)</option>
              <option value="UM">Ultrarapid (UM)</option>
            </select>
          </div>

          <!-- NEW: Phenotype prediction (API) -->
          <div class="divider"></div>

          <div class="field">
            <label id="phenoPredTitle" for="sexInput">Phenotype Prediction (API)</label>
            <div id="phenoPredHint" class="hint">
              Optional: use local API to predict CYP2D6 phenotype and auto-fill the field above.
            </div>
          </div>

          <div class="field">
            <label id="sexLabel" for="sexInput">Sex</label>
            <select id="sexInput">
              <option value="F" selected>F</option>
              <option value="M">M</option>
            </select>
          </div>

          <div class="field">
            <label id="inhibitorLabel" for="inhibitorInput">CYP2D6 inhibitor</label>
            <select id="inhibitorInput">
              <option value="no" selected>No</option>
              <option value="yes">Yes</option>
            </select>
            <div id="inhibitorHint" class="hint">Examples: strong CYP2D6 inhibitors may reduce CYP2D6 activity.</div>
          </div>

          <div class="field">
            <label id="codeineRespLabel" for="codeineRespInput">Prior codeine response</label>
            <select id="codeineRespInput">
              <option value="ineffective" selected>Ineffective</option>
              <option value="effective">Effective</option>
              <option value="toxicity">Toxicity</option>
            </select>
          </div>

          <div class="field">
            <label id="tramadolRespLabel" for="tramadolRespInput">Prior tramadol response</label>
            <select id="tramadolRespInput">
              <option value="ineffective" selected>Ineffective</option>
              <option value="effective">Effective</option>
              <option value="toxicity">Toxicity</option>
            </select>
          </div>

          <div class="actions">
            <button id="predictBtn" class="btn" type="button">Predict Phenotype</button>
            <div id="predictStatus" class="predict-status" aria-live="polite"></div>
          </div>

          <div class="divider"></div>

          <div class="checks">
            <label class="check"><input id="opioidTol" type="checkbox"><span id="opioidTolLabel">Opioid tolerant</span></label>
            <label class="check"><input id="sedatives" type="checkbox"><span id="sedativesLabel">Concurrent sedatives</span></label>
            <label class="check"><input id="respRisk" type="checkbox"><span id="respRiskLabel">Respiratory risk</span></label>
            <label class="check"><input id="suspectedACS" type="checkbox"><span id="acsLabel">Suspected ACS</span></label>
            <label class="check"><input id="morphineAllergy" type="checkbox"><span id="morphineAllergyLabel">Morphine allergy</span></label>
          </div>

          <div class="actions">
            <button id="runBtn" class="btn btn-primary" type="button">Run Algorithm</button>
            <button id="resetBtn" class="btn" type="button">Reset</button>
          </div>

          <div id="disclaimerText" class="smallprint">
            Educational prototype only. Not a substitute for clinical judgment.
          </div>
        </div>
      </section>

      <!-- Right: Results -->
      <section class="card">
        <h2 id="resultsTitle" class="card-title">Results</h2>

        <div id="results" class="results">
          <div id="placeholderText" class="placeholder">Enter inputs then click "Run Algorithm".</div>
        </div>

        <div class="refs">
          <h3 id="refsTitle">References</h3>
          <ul>
            <li><a id="mohLink" href="#" target="_blank" rel="noreferrer">Saudi MOH Protocol (example)</a></li>
            <li><a id="cpicLink" href="#" target="_blank" rel="noreferrer">CPIC CYP2D6 opioids guideline</a></li>
            <li><a id="ashLink" href="#" target="_blank" rel="noreferrer">ASH SCD pain guideline</a></li>
            <li><a id="owsianyLink" href="#" target="_blank" rel="noreferrer">Owsiany review (open access)</a></li>
          </ul>
        </div>
      </section>
    </main>
  </div>

  <script src="./app.js"></script>
</body>
</html>